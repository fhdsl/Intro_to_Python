<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Data Wrangling, Part 2 | Introduction to Python</title>
  <meta name="description" content="Description about Course/Book." />
  <meta name="generator" content="bookdown 0.39.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Data Wrangling, Part 2 | Introduction to Python" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Description about Course/Book." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Data Wrangling, Part 2 | Introduction to Python" />
  
  <meta name="twitter:description" content="Description about Course/Book." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/dasl_favicon.ico" type="image/x-icon" />
<link rel="prev" href="data-wrangling-part-1.html"/>
<link rel="next" href="data-visualization.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<a href="https://hutchdatascience.org/" target="_blank"><img src="assets/big-dasl-stacked.png" style="width: 80%; padding-left: 34px; padding-top: 8px;"</a>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this Course</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#curriculum"><i class="fa fa-check"></i><b>0.1</b> Curriculum</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#target-audience"><i class="fa fa-check"></i><b>0.2</b> Target Audience</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i><b>0.3</b> Learning Objectives</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#offerings"><i class="fa fa-check"></i><b>0.4</b> Offerings</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro-to-computing.html"><a href="intro-to-computing.html"><i class="fa fa-check"></i><b>1</b> Intro to Computing</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro-to-computing.html"><a href="intro-to-computing.html#goals-of-the-course"><i class="fa fa-check"></i><b>1.1</b> Goals of the course</a></li>
<li class="chapter" data-level="1.2" data-path="intro-to-computing.html"><a href="intro-to-computing.html#what-is-a-computer-program"><i class="fa fa-check"></i><b>1.2</b> What is a computer program?</a></li>
<li class="chapter" data-level="1.3" data-path="intro-to-computing.html"><a href="intro-to-computing.html#a-programming-language-has-following-elements"><i class="fa fa-check"></i><b>1.3</b> A programming language has following elements:</a></li>
<li class="chapter" data-level="1.4" data-path="intro-to-computing.html"><a href="intro-to-computing.html#google-colab-setup"><i class="fa fa-check"></i><b>1.4</b> Google Colab Setup</a></li>
<li class="chapter" data-level="1.5" data-path="intro-to-computing.html"><a href="intro-to-computing.html#grammar-structure-1-evaluation-of-expressions"><i class="fa fa-check"></i><b>1.5</b> Grammar Structure 1: Evaluation of Expressions</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="intro-to-computing.html"><a href="intro-to-computing.html#function-machine-schema"><i class="fa fa-check"></i><b>1.5.1</b> Function machine schema</a></li>
<li class="chapter" data-level="1.5.2" data-path="intro-to-computing.html"><a href="intro-to-computing.html#data-types"><i class="fa fa-check"></i><b>1.5.2</b> Data types</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="intro-to-computing.html"><a href="intro-to-computing.html#grammar-structure-2-storing-data-types-in-the-variable-environment"><i class="fa fa-check"></i><b>1.6</b> Grammar Structure 2: Storing data types in the Variable Environment</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="intro-to-computing.html"><a href="intro-to-computing.html#execution-rule-for-variable-assignment"><i class="fa fa-check"></i><b>1.6.1</b> Execution rule for variable assignment</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="intro-to-computing.html"><a href="intro-to-computing.html#grammar-structure-3-evaluation-of-functions"><i class="fa fa-check"></i><b>1.7</b> Grammar Structure 3: Evaluation of Functions</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="intro-to-computing.html"><a href="intro-to-computing.html#execution-rule-for-functions"><i class="fa fa-check"></i><b>1.7.1</b> Execution rule for functions:</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="intro-to-computing.html"><a href="intro-to-computing.html#tips-on-writing-your-first-code"><i class="fa fa-check"></i><b>1.8</b> Tips on writing your first code</a></li>
<li class="chapter" data-level="1.9" data-path="intro-to-computing.html"><a href="intro-to-computing.html#exercises"><i class="fa fa-check"></i><b>1.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html"><i class="fa fa-check"></i><b>2</b> Working with data structures</a>
<ul>
<li class="chapter" data-level="2.1" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#lists"><i class="fa fa-check"></i><b>2.1</b> Lists</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#subsetting-lists"><i class="fa fa-check"></i><b>2.1.1</b> Subsetting lists</a></li>
<li class="chapter" data-level="2.1.2" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#subsetting-multiple-elements-of-lists"><i class="fa fa-check"></i><b>2.1.2</b> Subsetting multiple elements of lists</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#objects-in-python"><i class="fa fa-check"></i><b>2.2</b> Objects in Python</a></li>
<li class="chapter" data-level="2.3" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#methods-vs-functions"><i class="fa fa-check"></i><b>2.3</b> Methods vs Functions</a></li>
<li class="chapter" data-level="2.4" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#dataframes"><i class="fa fa-check"></i><b>2.4</b> Dataframes</a></li>
<li class="chapter" data-level="2.5" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#what-does-a-dataframe-contain"><i class="fa fa-check"></i><b>2.5</b> What does a Dataframe contain?</a></li>
<li class="chapter" data-level="2.6" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#what-can-a-dataframe-do"><i class="fa fa-check"></i><b>2.6</b> What can a Dataframe do?</a></li>
<li class="chapter" data-level="2.7" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#subsetting-dataframes"><i class="fa fa-check"></i><b>2.7</b> Subsetting Dataframes</a></li>
<li class="chapter" data-level="2.8" data-path="working-with-data-structures.html"><a href="working-with-data-structures.html#exercises-1"><i class="fa fa-check"></i><b>2.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling-part-1.html"><a href="data-wrangling-part-1.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling, Part 1</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling-part-1.html"><a href="data-wrangling-part-1.html#tidy-data"><i class="fa fa-check"></i><b>3.1</b> Tidy Data</a></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling-part-1.html"><a href="data-wrangling-part-1.html#our-working-tidy-data-depmap-project"><i class="fa fa-check"></i><b>3.2</b> Our working Tidy Data: DepMap Project</a></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling-part-1.html"><a href="data-wrangling-part-1.html#transform-what-do-you-want-to-do-with-this-dataframe"><i class="fa fa-check"></i><b>3.3</b> Transform: “What do you want to do with this Dataframe”?</a></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling-part-1.html"><a href="data-wrangling-part-1.html#summary-statistics"><i class="fa fa-check"></i><b>3.4</b> Summary Statistics</a></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling-part-1.html"><a href="data-wrangling-part-1.html#simple-data-visualization"><i class="fa fa-check"></i><b>3.5</b> Simple data visualization</a></li>
<li class="chapter" data-level="3.6" data-path="data-wrangling-part-1.html"><a href="data-wrangling-part-1.html#exercises-2"><i class="fa fa-check"></i><b>3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-part-2.html"><a href="data-wrangling-part-2.html"><i class="fa fa-check"></i><b>4</b> Data Wrangling, Part 2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-part-2.html"><a href="data-wrangling-part-2.html#creating-new-columns"><i class="fa fa-check"></i><b>4.1</b> Creating new columns</a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-part-2.html"><a href="data-wrangling-part-2.html#merging-two-dataframes-together"><i class="fa fa-check"></i><b>4.2</b> Merging two Dataframes together</a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-part-2.html"><a href="data-wrangling-part-2.html#grouping-and-summarizing-dataframes"><i class="fa fa-check"></i><b>4.3</b> Grouping and summarizing Dataframes</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-wrangling-part-2.html"><a href="data-wrangling-part-2.html#optional-multiple-grouping-multiple-columns-multiple-summary-statistics"><i class="fa fa-check"></i><b>4.3.1</b> Optional: Multiple grouping, Multiple columns, Multiple summary statistics</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-part-2.html"><a href="data-wrangling-part-2.html#exercises-3"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>5</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-visualization.html"><a href="data-visualization.html#distributions-one-variable"><i class="fa fa-check"></i><b>5.1</b> Distributions (one variable)</a></li>
<li class="chapter" data-level="5.2" data-path="data-visualization.html"><a href="data-visualization.html#relational-between-2-continuous-variables"><i class="fa fa-check"></i><b>5.2</b> Relational (between 2 continuous variables)</a></li>
<li class="chapter" data-level="5.3" data-path="data-visualization.html"><a href="data-visualization.html#categorical-between-1-categorical-and-1-continuous-variable"><i class="fa fa-check"></i><b>5.3</b> Categorical (between 1 categorical and 1 continuous variable)</a></li>
<li class="chapter" data-level="5.4" data-path="data-visualization.html"><a href="data-visualization.html#basic-plot-customization"><i class="fa fa-check"></i><b>5.4</b> Basic plot customization</a></li>
<li class="chapter" data-level="5.5" data-path="data-visualization.html"><a href="data-visualization.html#other-resources"><i class="fa fa-check"></i><b>5.5</b> Other resources</a></li>
<li class="chapter" data-level="5.6" data-path="data-visualization.html"><a href="data-visualization.html#exercises-4"><i class="fa fa-check"></i><b>5.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the Authors</a></li>
<li class="chapter" data-level="6" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>6</b> References</a></li>
<li class="divider"></li>
<p style="text-align:center;"> <a href="https://github.com/jhudsl/OTTR_Template" target="blank" > This content was published with</a> <a href="https://bookdown.org/" target="blank"> bookdown by: </a> </p>
<p style="text-align:center;"> <a href="https://hutchdatascience.org/"> The Fred Hutch Data Science Lab </a></p>
<p style="text-align:center; font-size: 12px;"> <a href="https://github.com/rstudio4edu/rstudio4edu-book/"> Style adapted from: rstudio4edu-book </a> <a href ="https://creativecommons.org/licenses/by/2.0/"> (CC-BY 2.0) </a></p>
<p style="padding-left: 40px;"><div class="trapezoid" style = "padding-left: 40px;"><span>  <a href="https://forms.gle/W6Mg4rzuMK6Yk3Am8"> Click here to provide feedback</a> <img src="assets/itcr_arrow.png" style=" width: 10%" ></span></div></p>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Python</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <!--script src="https://kit.fontawesome.com/6a26f47516.js"></script-->
  <!--<script src="assets/hideOutput.js"></script>-->
  <link href="assets/style.css" rel="stylesheet">
</head>
        


<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/dasl_thin_main_image.png">
</div>
<div id="data-wrangling-part-2" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Data Wrangling, Part 2<a href="data-wrangling-part-2.html#data-wrangling-part-2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We will continue to learn about data analysis with Dataframes. Let’s load our three Dataframes from the Depmap project in again:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="data-wrangling-part-2.html#cb92-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb92-2"><a href="data-wrangling-part-2.html#cb92-2" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb92-3"><a href="data-wrangling-part-2.html#cb92-3" tabindex="-1"></a></span>
<span id="cb92-4"><a href="data-wrangling-part-2.html#cb92-4" tabindex="-1"></a>metadata <span class="op">=</span> pd.read_csv(<span class="st">&quot;classroom_data/metadata.csv&quot;</span>)</span>
<span id="cb92-5"><a href="data-wrangling-part-2.html#cb92-5" tabindex="-1"></a>mutation <span class="op">=</span> pd.read_csv(<span class="st">&quot;classroom_data/mutation.csv&quot;</span>)</span>
<span id="cb92-6"><a href="data-wrangling-part-2.html#cb92-6" tabindex="-1"></a>expression <span class="op">=</span> pd.read_csv(<span class="st">&quot;classroom_data/expression.csv&quot;</span>)</span></code></pre></div>
<div id="creating-new-columns" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Creating new columns<a href="data-wrangling-part-2.html#creating-new-columns" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Often, we want to perform some kind of transformation on our data’s columns: perhaps you want to add the values of columns together, or perhaps you want to represent your column in a different scale.</p>
<p>To create a new column, you simply modify it as if it exists using the bracket operation <code>[ ]</code>, and the column will be created:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="data-wrangling-part-2.html#cb93-1" tabindex="-1"></a>metadata[<span class="st">&#39;AgePlusTen&#39;</span>] <span class="op">=</span> metadata[<span class="st">&#39;Age&#39;</span>] <span class="op">+</span> <span class="dv">10</span></span>
<span id="cb93-2"><a href="data-wrangling-part-2.html#cb93-2" tabindex="-1"></a>expression[<span class="st">&#39;KRAS_NRAS_exp&#39;</span>] <span class="op">=</span> expression[<span class="st">&#39;KRAS_Exp&#39;</span>] <span class="op">+</span> expression[<span class="st">&#39;NRAS_Exp&#39;</span>]</span>
<span id="cb93-3"><a href="data-wrangling-part-2.html#cb93-3" tabindex="-1"></a>expression[<span class="st">&#39;log_PIK3CA_Exp&#39;</span>] <span class="op">=</span> np.log(expression[<span class="st">&#39;PIK3CA_Exp&#39;</span>])</span></code></pre></div>
<p>where <a href="https://numpy.org/doc/stable/reference/generated/numpy.log.html"><code>np.log(x)</code></a> is a function imported from the module NumPy that takes in a numeric and returns the log-transformed value.</p>
<p>Note: you cannot create a new column referring to the attribute of the Dataframe, such as: <code>expression.KRAS_Exp_log = np.log(expression.KRAS_Exp)</code>.</p>
</div>
<div id="merging-two-dataframes-together" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Merging two Dataframes together<a href="data-wrangling-part-2.html#merging-two-dataframes-together" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose we have the following Dataframes:</p>
<p><code>expression</code></p>
<table>
<thead>
<tr class="header">
<th>ModelID</th>
<th>PIK3CA_Exp</th>
<th>log_PIK3CA_Exp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“ACH-001113”</td>
<td>5.138733</td>
<td>1.636806</td>
</tr>
<tr class="even">
<td>“ACH-001289”</td>
<td>3.184280</td>
<td>1.158226</td>
</tr>
<tr class="odd">
<td>“ACH-001339”</td>
<td>3.165108</td>
<td>1.152187</td>
</tr>
</tbody>
</table>
<p><code>metadata</code></p>
<table>
<thead>
<tr class="header">
<th>ModelID</th>
<th>OncotreeLineage</th>
<th>Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“ACH-001113”</td>
<td>“Lung”</td>
<td>69</td>
</tr>
<tr class="even">
<td>“ACH-001289”</td>
<td>“CNS/Brain”</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td>“ACH-001339”</td>
<td>“Skin”</td>
<td>14</td>
</tr>
</tbody>
</table>
<p>Suppose that I want to compare the relationship between <code>OncotreeLineage</code> and <code>PIK3CA_Exp</code>, but they are columns in different Dataframes. We want a new Dataframe that looks like this:</p>
<table>
<thead>
<tr class="header">
<th>ModelID</th>
<th>PIK3CA_Exp</th>
<th>log_PIK3CA_Exp</th>
<th>OncotreeLineage</th>
<th>Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“ACH-001113”</td>
<td>5.138733</td>
<td>1.636806</td>
<td>“Lung”</td>
<td>69</td>
</tr>
<tr class="even">
<td>“ACH-001289”</td>
<td>3.184280</td>
<td>1.158226</td>
<td>“CNS/Brain”</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td>“ACH-001339”</td>
<td>3.165108</td>
<td>1.152187</td>
<td>“Skin”</td>
<td>14</td>
</tr>
</tbody>
</table>
<p>We see that in both dataframes,</p>
<ul>
<li><p>the rows (observations) represent cell lines.</p></li>
<li><p>there is a common column <code>ModelID</code>, with shared values between the two dataframes that can faciltate the merging process. We call this an <strong>index</strong>.</p></li>
</ul>
<p>We will use the method <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html"><code>.merge()</code></a> for Dataframes. It takes a Dataframe to merge with as the required input argument. The method looks for a common index column between the two dataframes and merge based on that index.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb94-1"><a href="data-wrangling-part-2.html#cb94-1" tabindex="-1"></a>merged <span class="op">=</span> metadata.merge(expression)</span></code></pre></div>
<p>It’s usually better to specify what that index column to avoid ambiguity, using the <code>on</code> optional argument:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="data-wrangling-part-2.html#cb95-1" tabindex="-1"></a>merged <span class="op">=</span> metadata.merge(expression, on<span class="op">=</span><span class="st">&#39;ModelID&#39;</span>)</span></code></pre></div>
<p>If the index column for the two Dataframes are named differently, you can specify the column name for each Dataframe:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb96-1"><a href="data-wrangling-part-2.html#cb96-1" tabindex="-1"></a>merged <span class="op">=</span> metadata.merge(expression, left_on<span class="op">=</span><span class="st">&#39;ModelID&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;ModelID&#39;</span>)</span></code></pre></div>
<p>One of the most import checks you should do when merging dataframes is to look at the number of rows and columns before and after merging to see whether it makes sense or not:</p>
<p>The number of rows and columns of <code>metadata</code>:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb97-1"><a href="data-wrangling-part-2.html#cb97-1" tabindex="-1"></a>metadata.shape</span></code></pre></div>
<pre><code>## (1864, 31)</code></pre>
<p>The number of rows and columns of <code>expression</code>:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="data-wrangling-part-2.html#cb99-1" tabindex="-1"></a>expression.shape</span></code></pre></div>
<pre><code>## (1450, 538)</code></pre>
<p>The number of rows and columns of <code>merged</code>:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb101-1"><a href="data-wrangling-part-2.html#cb101-1" tabindex="-1"></a>merged.shape</span></code></pre></div>
<pre><code>## (1450, 568)</code></pre>
<p>We see that the number of <em>columns</em> in <code>merged</code> combines the number of columns in <code>metadata</code> and <code>expression</code>, while the number of <em>rows</em> in <code>merged</code> is the smaller of the number of rows in <code>metadata</code> and <code>expression</code>: it only keeps rows that are found in both Dataframe’s index columns. This kind of join is called “inner join”, because in the Venn Diagram of elements common in both index column, we keep the inner overlap:</p>
<p><img src="images/join.png" /></p>
<p>You can specifiy the join style by changing the optional input argument <code>how</code>.</p>
<ul>
<li><p><code>how = "outer"</code> keeps all observations - also known as a “full join”</p></li>
<li><p><code>how = "left"</code> keeps all observations in the left Dataframe.</p></li>
<li><p><code>how = "right"</code> keeps all observations in the right Dataframe.</p></li>
<li><p><code>how = "inner"</code> keeps observations common to both Dataframe. This is the default value of <code>how</code>.</p></li>
</ul>
</div>
<div id="grouping-and-summarizing-dataframes" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Grouping and summarizing Dataframes<a href="data-wrangling-part-2.html#grouping-and-summarizing-dataframes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In a dataset, there may be groups of observations that we want to understand, such as case vs. control, or comparing different cancer subtypes. For example, in <code>metadata</code>, the observation is cell lines, and perhaps we want to group cell lines into their respective cancer type, <code>OncotreeLineage</code>, and look at the mean age for each cancer type.</p>
<p>We want to take <code>metadata</code>:</p>
<table>
<thead>
<tr class="header">
<th>ModelID</th>
<th>OncotreeLineage</th>
<th>Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“ACH-001113”</td>
<td>“Lung”</td>
<td>69</td>
</tr>
<tr class="even">
<td>“ACH-001289”</td>
<td>“Lung”</td>
<td>23</td>
</tr>
<tr class="odd">
<td>“ACH-001339”</td>
<td>“Skin”</td>
<td>14</td>
</tr>
<tr class="even">
<td>“ACH-002342”</td>
<td>“Brain”</td>
<td>23</td>
</tr>
<tr class="odd">
<td>“ACH-004854”</td>
<td>“Brain”</td>
<td>56</td>
</tr>
<tr class="even">
<td>“ACH-002921”</td>
<td>“Brain”</td>
<td>67</td>
</tr>
</tbody>
</table>
<p>into:</p>
<table>
<thead>
<tr class="header">
<th>OncotreeLineage</th>
<th>MeanAge</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“Lung”</td>
<td>46</td>
</tr>
<tr class="even">
<td>“Skin”</td>
<td>14</td>
</tr>
<tr class="odd">
<td>“Brain”</td>
<td>48.67</td>
</tr>
</tbody>
</table>
<p>To get there, we need to:</p>
<ul>
<li><p><strong>Group</strong> the data based on some criteria, elements of <code>OncotreeLineage</code></p></li>
<li><p><strong>Summarize</strong> each group via a summary statistic performed on a column, such as <code>Age</code>.</p></li>
</ul>
<p>We use the methods <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html"><code>.group_by(x)</code></a> and <code>.mean()</code>.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="data-wrangling-part-2.html#cb103-1" tabindex="-1"></a>metadata_grouped <span class="op">=</span> metadata.groupby(<span class="st">&quot;OncotreeLineage&quot;</span>)</span>
<span id="cb103-2"><a href="data-wrangling-part-2.html#cb103-2" tabindex="-1"></a>metadata_grouped[<span class="st">&#39;Age&#39;</span>].mean()</span></code></pre></div>
<pre><code>## OncotreeLineage
## Adrenal Gland                55.000000
## Ampulla of Vater             65.500000
## Biliary Tract                58.450000
## Bladder/Urinary Tract        65.166667
## Bone                         20.854545
## Bowel                        58.611111
## Breast                       50.961039
## CNS/Brain                    43.849057
## Cervix                       47.136364
## Esophagus/Stomach            57.855556
## Eye                          51.100000
## Fibroblast                   38.194444
## Head and Neck                60.149254
## Kidney                       46.193548
## Liver                        43.928571
## Lung                         55.444444
## Lymphoid                     38.916667
## Myeloid                      38.810811
## Normal                       52.370370
## Other                        46.000000
## Ovary/Fallopian Tube         51.980769
## Pancreas                     60.226415
## Peripheral Nervous System     5.480000
## Pleura                       61.000000
## Prostate                     61.666667
## Skin                         49.033708
## Soft Tissue                  27.500000
## Testis                       25.000000
## Thyroid                      63.235294
## Uterus                       62.060606
## Vulva/Vagina                 75.400000
## Name: Age, dtype: float64</code></pre>
<p>Here’s what’s going on:</p>
<ul>
<li><p>We use the Dataframe method <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html"><code>.group_by(x)</code></a> and specify the column we want to group by. The output of this method is a <strong>Grouped Dataframe object</strong>. It still contains all the information of the <code>metadata</code> Dataframe, but it makes a note that it’s been grouped.</p></li>
<li><p>We subset to the column <code>Age</code>. The grouping information still persists (This is a Grouped Series object).</p></li>
<li><p>We use the method <code>.mean()</code> to calculate the mean value of <code>Age</code> within each group defined by <code>OncotreeLineage</code>.</p></li>
</ul>
<p>Alternatively, this could have been done in a chain of methods:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb105-1"><a href="data-wrangling-part-2.html#cb105-1" tabindex="-1"></a>metadata.groupby(<span class="st">&quot;OncotreeLineage&quot;</span>)[<span class="st">&quot;Age&quot;</span>].mean()</span></code></pre></div>
<pre><code>## OncotreeLineage
## Adrenal Gland                55.000000
## Ampulla of Vater             65.500000
## Biliary Tract                58.450000
## Bladder/Urinary Tract        65.166667
## Bone                         20.854545
## Bowel                        58.611111
## Breast                       50.961039
## CNS/Brain                    43.849057
## Cervix                       47.136364
## Esophagus/Stomach            57.855556
## Eye                          51.100000
## Fibroblast                   38.194444
## Head and Neck                60.149254
## Kidney                       46.193548
## Liver                        43.928571
## Lung                         55.444444
## Lymphoid                     38.916667
## Myeloid                      38.810811
## Normal                       52.370370
## Other                        46.000000
## Ovary/Fallopian Tube         51.980769
## Pancreas                     60.226415
## Peripheral Nervous System     5.480000
## Pleura                       61.000000
## Prostate                     61.666667
## Skin                         49.033708
## Soft Tissue                  27.500000
## Testis                       25.000000
## Thyroid                      63.235294
## Uterus                       62.060606
## Vulva/Vagina                 75.400000
## Name: Age, dtype: float64</code></pre>
<p>Once a Dataframe has been grouped and a column is selected, all the summary statistics methods you learned from last week, such as <code>.mean()</code>, <code>.median()</code>, <code>.max()</code>, can be used. One new summary statistics method that is useful for this grouping and summarizing analysis is <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.count.html"><code>.count()</code></a> which tells you how many entries are counted within each group.</p>
<div id="optional-multiple-grouping-multiple-columns-multiple-summary-statistics" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Optional: Multiple grouping, Multiple columns, Multiple summary statistics<a href="data-wrangling-part-2.html#optional-multiple-grouping-multiple-columns-multiple-summary-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sometimes, when performing grouping and summary analysis, you want to operate on multiple columns simultaneously.</p>
<p>For example, you may want to group by a combination of <code>OncotreeLineage</code> and <code>AgeCategory</code>, such as “Lung” and “Adult” as one grouping. You can do so like this:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="data-wrangling-part-2.html#cb107-1" tabindex="-1"></a>metadata_grouped <span class="op">=</span> metadata.groupby([<span class="st">&quot;OncotreeLineage&quot;</span>, <span class="st">&quot;AgeCategory&quot;</span>])</span>
<span id="cb107-2"><a href="data-wrangling-part-2.html#cb107-2" tabindex="-1"></a>metadata_grouped[<span class="st">&#39;Age&#39;</span>].mean()</span></code></pre></div>
<pre><code>## OncotreeLineage   AgeCategory
## Adrenal Gland     Adult          55.000000
## Ampulla of Vater  Adult          65.500000
##                   Unknown              NaN
## Biliary Tract     Adult          58.450000
##                   Unknown              NaN
##                                    ...    
## Thyroid           Unknown              NaN
## Uterus            Adult          62.060606
##                   Fetus                NaN
##                   Unknown              NaN
## Vulva/Vagina      Adult          75.400000
## Name: Age, Length: 72, dtype: float64</code></pre>
<p>You can also summarize on multiple columns simultaneously. For each column, you have to specify what summary statistic functions you want to use. This can be specified via the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.agg.html"><code>.agg(x)</code></a> method on a Grouped Dataframe.</p>
<p>For example, coming back to our age case-control Dataframe,</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb109-1"><a href="data-wrangling-part-2.html#cb109-1" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>{<span class="st">&#39;status&#39;</span>: [<span class="st">&quot;treated&quot;</span>, <span class="st">&quot;untreated&quot;</span>, <span class="st">&quot;untreated&quot;</span>, <span class="st">&quot;discharged&quot;</span>, <span class="st">&quot;treated&quot;</span>],</span>
<span id="cb109-2"><a href="data-wrangling-part-2.html#cb109-2" tabindex="-1"></a>                            <span class="st">&#39;age_case&#39;</span>: [<span class="dv">25</span>, <span class="dv">43</span>, <span class="dv">21</span>, <span class="dv">65</span>, <span class="dv">7</span>],</span>
<span id="cb109-3"><a href="data-wrangling-part-2.html#cb109-3" tabindex="-1"></a>                            <span class="st">&#39;age_control&#39;</span>: [<span class="dv">49</span>, <span class="dv">20</span>, <span class="dv">32</span>, <span class="dv">25</span>, <span class="dv">32</span>]})</span>
<span id="cb109-4"><a href="data-wrangling-part-2.html#cb109-4" tabindex="-1"></a>                            </span>
<span id="cb109-5"><a href="data-wrangling-part-2.html#cb109-5" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##        status  age_case  age_control
## 0     treated        25           49
## 1   untreated        43           20
## 2   untreated        21           32
## 3  discharged        65           25
## 4     treated         7           32</code></pre>
<p>We group by <code>status</code> and summarize <code>age_case</code> and <code>age_control</code> with a few summary statistics each:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="data-wrangling-part-2.html#cb111-1" tabindex="-1"></a>df.groupby(<span class="st">&quot;status&quot;</span>).agg({<span class="st">&quot;age_case&quot;</span>: <span class="st">&quot;mean&quot;</span>, <span class="st">&quot;age_control&quot;</span>: [<span class="st">&quot;min&quot;</span>, <span class="st">&quot;max&quot;</span>, <span class="st">&quot;mean&quot;</span>]})</span></code></pre></div>
<pre><code>##            age_case age_control          
##                mean         min max  mean
## status                                   
## discharged     65.0          25  25  25.0
## treated        16.0          32  49  40.5
## untreated      32.0          20  32  26.0</code></pre>
<p>The input argument to the <code>.agg(x)</code> method is called a <a href="https://docs.python.org/3/tutorial/datastructures.html#dictionaries">Dictionary</a>, which let’s you structure information in a paired relationship. You can learn more about dictionaries here.</p>
</div>
</div>
<div id="exercises-3" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Exercises<a href="data-wrangling-part-2.html#exercises-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Exercise for week 4 can be found <a href="https://colab.research.google.com/drive/1ntkUdKQ209vu1M89rcsBst-pKKuwzdwX?usp=sharing">here</a>.</p>

</div>
</div>
<hr>
<center> 
  <div class="footer">
      All illustrations <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY. </a>
      <br>
      All other materials <a href= "https://creativecommons.org/licenses/by/4.0/"> CC-BY </a> unless noted otherwise.
      <a href="https://hutchdatascience.org/" target="_blank"><img src="https://hutchdatascience.org/images/crazy-idea-wide.png" style="width: 80%; padding-left: 15px; padding-top: 8px;"</a>
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="data-wrangling-part-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-visualization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
